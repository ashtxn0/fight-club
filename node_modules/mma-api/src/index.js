/*
  NodeJS based MMA API providing fighter's data by crawling sherdog
  Copyright: [woog2roid]
  License: [MIT]
*/

const { getSherdogURL } = require('./getSherdogURL');
const { getFighterData } = require('./getFighterData');
const GoogleImages = require('google-images');

const sherdog= new GoogleImages('61dbb873d00b44bb8','AIzaSyDoTSRFslLfpiM0byub6epe67rP-PT_Ooc');

//1.search fighter's sherdog url by google
//2.parse data from sherdog url
const api = async (fighter, callback) => {
	try {
		const found = await sherdog.search(fighter);
		const url = found[0].parentPage;
		// const url = await getSherdogURL(fighter);
		const data = await getFighterData(url);
		if(callback && (typeof callback == "function")) callback(data);
		return data;
	} catch(err) {
		console.log(err);
	}
};

const url = async (url,callback) => {
	try {
		// const url = await getSherdogURL(fighter);
		const data = await getFighterData(url);
		if(callback && (typeof callback == "function")) callback(data);
		return data;
	} catch(err) {
		console.log(err);
	}
};


module.exports.api = api;
module.exports.url = url;